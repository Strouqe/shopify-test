{% comment %}
  This section is used in the collection template to render collection page
  listing all products within a collection.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/collection
{% endcomment %}

<h1>{{ collection.title }}</h1>

<div class="collection-products">
{% assign available_products = collection.products | where: 'available' %}
{% assign out_of_stock_products = collection.products | where: 'available', false %}
{% assign sorted_products = available_products | concat: out_of_stock_products %}

{% paginate collection.products by 24 %}
  {% assign page_size = paginate.page_size %}
  {% assign start_index = paginate.current_page | minus: 1 | times: page_size %}

  {% capture children %}
    {% for product in sorted_products offset: start_index limit: page_size %}
      <li
        id="{{ section.id }}-{{ product.id }}"
        class="product-grid__item product-grid__item--{{ forloop.index0 }}"
        data-page="{{ paginate.current_page }}"
        data-product-id="{{ product.id }}"
        ref="cards[]"
      >
        {% # theme-check-disable %}
        {% content_for 'block', type: '_product-card', id: 'product-card', closest.product: product %}
        {% # theme-check-enable %}
      </li>
    {% endfor %}
  {% endcapture %}

    {{ paginate | default_pagination }}
  {% endpaginate %}
</div>

{% stylesheet %}
  .collection-products {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.collection",
  "settings": []
}
{% endschema %}
